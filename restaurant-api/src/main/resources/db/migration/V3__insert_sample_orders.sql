-- 插入示例订单和订单项数据
USE restaurant_dev;

-- 插入订单数据
INSERT INTO orders (order_number, table_id, customer_id, staff_user_id, total_amount, status, remark, created_at, updated_at) VALUES 
-- 今日订单
('ORDER20250724001', 1, 1, 2, 85.00, 'COMPLETED', '不要辣', '2025-07-24 12:30:00', '2025-07-24 13:15:00'),
('ORDER20250724002', 2, 2, 2, 63.00, 'READY', '多加点醋', '2025-07-24 13:15:00', '2025-07-24 13:45:00'),
('ORDER20250724003', 3, 1, 2, 45.00, 'PREPARING', '', '2025-07-24 14:20:00', '2025-07-24 14:25:00'),
('ORDER20250724004', 1, 3, 2, 92.00, 'CONFIRMED', '汤要热一点', '2025-07-24 15:10:00', '2025-07-24 15:12:00'),
('ORDER20250724005', 4, 2, 2, 38.00, 'PENDING', '', '2025-07-24 16:05:00', '2025-07-24 16:05:00'),

-- 昨日订单
('ORDER20250723001', 1, 1, 2, 76.00, 'COMPLETED', '', '2025-07-23 11:45:00', '2025-07-23 12:30:00'),
('ORDER20250723002', 2, 3, 2, 54.00, 'COMPLETED', '少盐', '2025-07-23 12:20:00', '2025-07-23 13:05:00'),
('ORDER20250723003', 3, 2, 2, 67.00, 'COMPLETED', '', '2025-07-23 13:30:00', '2025-07-23 14:15:00'),
('ORDER20250723004', 5, 1, 2, 89.00, 'COMPLETED', '菜品要热', '2025-07-23 18:15:00', '2025-07-23 19:00:00'),
('ORDER20250723005', 2, 3, 2, 43.00, 'CANCELLED', '客户取消', '2025-07-23 19:30:00', '2025-07-23 19:35:00'),

-- 前日订单
('ORDER20250722001', 1, 2, 2, 58.00, 'COMPLETED', '', '2025-07-22 12:00:00', '2025-07-22 12:45:00'),
('ORDER20250722002', 3, 1, 2, 71.00, 'COMPLETED', '不要香菜', '2025-07-22 13:15:00', '2025-07-22 14:00:00'),
('ORDER20250722003', 4, 3, 2, 95.00, 'COMPLETED', '', '2025-07-22 17:45:00', '2025-07-22 18:30:00');

-- 插入订单项数据
INSERT INTO order_items (order_id, dish_id, quantity, unit_price, subtotal, created_at, updated_at) VALUES 
-- ORDER20250724001 的订单项 (总计85.00)
(1, 1, 1, 28.00, 28.00, '2025-07-24 12:30:00', '2025-07-24 12:30:00'), -- 宫保鸡丁
(1, 3, 1, 35.00, 35.00, '2025-07-24 12:30:00', '2025-07-24 12:30:00'), -- 红烧肉
(1, 11, 1, 15.00, 15.00, '2025-07-24 12:30:00', '2025-07-24 12:30:00'), -- 西红柿鸡蛋汤
(1, 17, 1, 15.00, 15.00, '2025-07-24 12:30:00', '2025-07-24 12:30:00'), -- 鲜榨橙汁

-- ORDER20250724002 的订单项 (总计63.00)
(2, 2, 1, 18.00, 18.00, '2025-07-24 13:15:00', '2025-07-24 13:15:00'), -- 麻婆豆腐
(2, 5, 1, 26.00, 26.00, '2025-07-24 13:15:00', '2025-07-24 13:15:00'), -- 鱼香肉丝
(2, 7, 1, 12.00, 12.00, '2025-07-24 13:15:00', '2025-07-24 13:15:00'), -- 凉拌黄瓜
(2, 21, 1, 8.00, 8.00, '2025-07-24 13:15:00', '2025-07-24 13:15:00'),   -- 可乐

-- ORDER20250724003 的订单项 (总计45.00)
(3, 4, 1, 32.00, 32.00, '2025-07-24 14:20:00', '2025-07-24 14:20:00'), -- 糖醋里脊
(3, 13, 1, 12.00, 12.00, '2025-07-24 14:20:00', '2025-07-24 14:20:00'), -- 紫菜蛋花汤
(3, 23, 1, 8.00, 8.00, '2025-07-24 14:20:00', '2025-07-24 14:20:00'),   -- 雪碧

-- ORDER20250724004 的订单项 (总计92.00)
(4, 1, 1, 28.00, 28.00, '2025-07-24 15:10:00', '2025-07-24 15:10:00'), -- 宫保鸡丁
(4, 6, 1, 30.00, 30.00, '2025-07-24 15:10:00', '2025-07-24 15:10:00'), -- 回锅肉
(4, 8, 1, 25.00, 25.00, '2025-07-24 15:10:00', '2025-07-24 15:10:00'), -- 口水鸡
(4, 12, 1, 28.00, 28.00, '2025-07-24 15:10:00', '2025-07-24 15:10:00'), -- 冬瓜排骨汤

-- ORDER20250724005 的订单项 (总计38.00)
(5, 9, 1, 10.00, 10.00, '2025-07-24 16:05:00', '2025-07-24 16:05:00'), -- 拍黄瓜
(5, 10, 1, 15.00, 15.00, '2025-07-24 16:05:00', '2025-07-24 16:05:00'), -- 凉拌木耳
(5, 13, 1, 12.00, 12.00, '2025-07-24 16:05:00', '2025-07-24 16:05:00'), -- 紫菜蛋花汤

-- ORDER20250723001 的订单项 (总计76.00)
(6, 3, 1, 35.00, 35.00, '2025-07-23 11:45:00', '2025-07-23 11:45:00'), -- 红烧肉
(6, 2, 1, 18.00, 18.00, '2025-07-23 11:45:00', '2025-07-23 11:45:00'), -- 麻婆豆腐
(6, 11, 1, 15.00, 15.00, '2025-07-23 11:45:00', '2025-07-23 11:45:00'), -- 西红柿鸡蛋汤
(6, 19, 1, 12.00, 12.00, '2025-07-23 11:45:00', '2025-07-23 11:45:00'), -- 绿豆汤

-- ORDER20250723002 的订单项 (总计54.00)
(7, 5, 1, 26.00, 26.00, '2025-07-23 12:20:00', '2025-07-23 12:20:00'), -- 鱼香肉丝
(7, 7, 1, 12.00, 12.00, '2025-07-23 12:20:00', '2025-07-23 12:20:00'), -- 凉拌黄瓜
(7, 14, 1, 18.00, 18.00, '2025-07-23 12:20:00', '2025-07-23 12:20:00'), -- 酸辣汤

-- ORDER20250723003 的订单项 (总计67.00)
(8, 1, 1, 28.00, 28.00, '2025-07-23 13:30:00', '2025-07-23 13:30:00'), -- 宫保鸡丁
(8, 4, 1, 32.00, 32.00, '2025-07-23 13:30:00', '2025-07-23 13:30:00'), -- 糖醋里脊
(8, 17, 1, 15.00, 15.00, '2025-07-23 13:30:00', '2025-07-23 13:30:00'), -- 鲜榨橙汁

-- ORDER20250723004 的订单项 (总计89.00)
(9, 6, 1, 30.00, 30.00, '2025-07-23 18:15:00', '2025-07-23 18:15:00'), -- 回锅肉
(9, 8, 1, 25.00, 25.00, '2025-07-23 18:15:00', '2025-07-23 18:15:00'), -- 口水鸡
(9, 11, 1, 28.00, 28.00, '2025-07-23 18:15:00', '2025-07-23 18:15:00'), -- 蒜泥白肉
(9, 12, 1, 28.00, 28.00, '2025-07-23 18:15:00', '2025-07-23 18:15:00'), -- 冬瓜排骨汤

-- ORDER20250723005 的订单项 (总计43.00 - 已取消)
(10, 2, 1, 18.00, 18.00, '2025-07-23 19:30:00', '2025-07-23 19:30:00'), -- 麻婆豆腐
(10, 8, 1, 25.00, 25.00, '2025-07-23 19:30:00', '2025-07-23 19:30:00'), -- 口水鸡

-- ORDER20250722001 的订单项 (总计58.00)
(11, 4, 1, 32.00, 32.00, '2025-07-22 12:00:00', '2025-07-22 12:00:00'), -- 糖醋里脊
(11, 7, 1, 12.00, 12.00, '2025-07-22 12:00:00', '2025-07-22 12:00:00'), -- 凉拌黄瓜
(11, 18, 1, 18.00, 18.00, '2025-07-22 12:00:00', '2025-07-22 12:00:00'), -- 柠檬蜂蜜茶

-- ORDER20250722002 的订单项 (总计71.00)
(12, 1, 1, 28.00, 28.00, '2025-07-22 13:15:00', '2025-07-22 13:15:00'), -- 宫保鸡丁
(12, 5, 1, 26.00, 26.00, '2025-07-22 13:15:00', '2025-07-22 13:15:00'), -- 鱼香肉丝
(12, 17, 1, 15.00, 15.00, '2025-07-22 13:15:00', '2025-07-22 13:15:00'), -- 鲜榨橙汁

-- ORDER20250722003 的订单项 (总计95.00)
(13, 3, 1, 35.00, 35.00, '2025-07-22 17:45:00', '2025-07-22 17:45:00'), -- 红烧肉
(13, 6, 1, 30.00, 30.00, '2025-07-22 17:45:00', '2025-07-22 17:45:00'), -- 回锅肉
(13, 8, 1, 25.00, 25.00, '2025-07-22 17:45:00', '2025-07-22 17:45:00'), -- 口水鸡
(13, 15, 1, 20.00, 20.00, '2025-07-22 17:45:00', '2025-07-22 17:45:00'); -- 银耳莲子汤

-- 更新顾客统计信息
UPDATE customers SET 
    total_orders = (SELECT COUNT(*) FROM orders WHERE customer_id = customers.id AND status != 'CANCELLED'),
    total_amount = (SELECT COALESCE(SUM(total_amount), 0) FROM orders WHERE customer_id = customers.id AND status != 'CANCELLED')
WHERE id IN (1, 2, 3);